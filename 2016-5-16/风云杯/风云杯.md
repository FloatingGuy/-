# é£äº‘æ¯
è¿™æ˜¯å›¢é˜Ÿæ”¹åæˆä¸º 'Mirage' ä¹‹åçš„ç¬¬ä¸€æ¬¡å‚åŠ æ¯”èµ›ã€‚æœ€åçš„ç»“æœæ˜¯å¾—åˆ°äº†ç¬¬13åã€‚è™½ç„¶æ¯”èµ›æ¯”è¾ƒç®€å•ï¼Œå¤§ç¥ä»¬éƒ½å»ç©WHCTFäº†ï¼Œä½†æ˜¯ç¦»èƒ½å¾—å¥–å“çš„å‰åè¿˜æœ‰ä¸€ç‚¹ç‚¹è·ç¦»ï¼Œç¦»æœ€ç»ˆèƒ½å¤Ÿè¿›å†³èµ›è¿˜æœ‰æ¯”è¾ƒå¤§çš„å·®è·ã€‚

![](https://raw.githubusercontent.com/GoldsNow/-/dd512ac4ab4ad3305fe3c57e9252ac1734ccff0e/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/end.png)

## MISC1
ä½¿ç”¨010æ‰“å¼€æ–‡ä»¶

![](https://raw.githubusercontent.com/GoldsNow/-/dd512ac4ab4ad3305fe3c57e9252ac1734ccff0e/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/misc1.png)

åœ¨æ—¶é—´åé¢æœ‰ä¸€æ®µå¾ˆå¥‡æ€ªçš„å­—ç¬¦ä¸² base64è§£å¯†è¯•ä¸€æ¬¡ get
## MISC2
![](https://raw.githubusercontent.com/GoldsNow/-/dd512ac4ab4ad3305fe3c57e9252ac1734ccff0e/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/misc2.png)

åœ¨010ä¸­å‘ç°å°¾éƒ¨é“¾æ¥è¿™ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼ŒæŠ å‡ºæ¥ç„¶åå‘ç°é‡Œé¢æ˜¯ä¸€ä¸ªåŠ å¯†è¿‡çš„flag.txt æç¤ºæ˜¯é“¶è¡Œå¡å¯†ç ï¼Œ  æ¨å‡ºæ˜¯6ä¸ºæ•°å­—ï¼Œçˆ†ç ´ä¸€ä¸‹å‡ºç»“æœ
## MISC3
ç›´æ¥çœ‹å±æ€§å°±å­˜åœ¨flag

## MISC4

ä¼ªåŠ å¯†ï¼Œç”¨ZipCenOp.jar æ¥è§£ä¸€ä¸‹
![](https://raw.githubusercontent.com/GoldsNow/-/dd512ac4ab4ad3305fe3c57e9252ac1734ccff0e/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/misc3.png)

å‡ºç„¶åå‡ºç°ä¸€å¼ å›¾ç‰‡ æ‹‰åˆ°010ä¸­åˆ†æ æœç´¢ä¸€ä¸‹æ–‡ä»¶å¤´ å‘ç°æœ‰ä¸‰å¼ å›¾ç‰‡åœ¨é‡Œé¢ 
![](https://raw.githubusercontent.com/GoldsNow/-/dd512ac4ab4ad3305fe3c57e9252ac1734ccff0e/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/misc4.png)

åœ¨æœ€åé¢è¿˜æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç»§ç»­åˆ†æï¼Œï¼Œåˆ°æ–‡ä»¶çš„æœ€åé¢çš„åœ°æ–¹å‘ç°äº†å­—ç¬¦ä¸²ï¼Œåé¢æœ‰å››ä¸ª==== è§‰å¾—åƒbase64åŠ å¯†  ä½†æ˜¯æœ‰æ²¡æœ‰è¿™ä¹ˆå¤šç­‰å·ã€‚ã€‚ç»§ç»­çœ‹ å‘ç°æ¯ä¸¤å¼ å›¾ç‰‡ä¹‹é—´è¿˜æœ‰å­—ç¬¦ä¸²ã€‚ã€‚

![](https://raw.githubusercontent.com/GoldsNow/-/dd512ac4ab4ad3305fe3c57e9252ac1734ccff0e/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/misc5.png)

é‚£å¥½ ä¸€æ¡ä¸€æ¡è¿è¿‡æ¥ï¼Œåˆ°æœ€åç”¨base32 è§£å¯†ä¸€ä¸‹ å¾ˆå¿«å°±å‡ºç­”æ¡ˆäº† å¹¶ä¸éš¾
é™„ä¸Šbase32çš„ç½‘ç«™è¿æ¥ 
[http://emn178.github.io/online-tools/base32_decode.html](http://emn178.github.io/online-tools/base32_decode.html)


## MISC5
PDFåŠ å¯† å¯ä»¥åœ¨ç½‘ä¸Šæ‰¾åˆ°å·¥å…·
åœ¨è¿™é‡Œæˆ‘ä»¬å°±ä¸æ‰¾å·¥å…·äº†ï¼ŒçŸ¥é“è—æ•°æ®çš„åŸç†ä¹‹åä¹Ÿæ˜¯è§£è§£å¾ˆæ–¹ä¾¿çš„ï¼Œ
åœ¨010ä¸­æ‰“å¼€PDFè¿›è¡Œåˆ†æ
![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/misc6.png)
åœ¨å›¾ç‰‡ä¸­èƒ½å¤Ÿå¾ˆæ¸…æ¥šçš„æ˜¾ç¤ºè¿™é‡Œæœ‰å¥½å¤šå—8å­—èŠ‚çš„æ•° 20ä»£è¡¨0 09ä»£è¡¨1
è¿™æ ·å­æ¯ä¸€ä¸ªæ•°æ®å—éƒ½ä»£è¡¨ä¸€ä¸ªæ•°å­—

å†æ¥çœ‹ä¸€ä¸‹ï¼Œè¿™å‰åéƒ½æœ‰ endobj  ------- X 0 obj è¿™ä¸ªå°±æ˜¯æ•°æ®å­˜å‚¨çš„æ ‡å¿—ï¼Œå†æ¥çœ‹ä¸€ä¸‹ï¼Œï¼Œæ¯ä¸€ä¸ªæ•°æ®ç‚¹éƒ½æ˜¯åœ¨ >>   << ä¹‹é—´ï¼Œï¼Œå°±å¯ä»¥ä»£è¡¨æ¯ä¸ªæ•°æ®å—éƒ½æ˜¯åœ¨æ®µä¸æ®µä¹‹é—´ä¸å¹²æ‰°çš„ä½ç½®ï¼Œå¾ˆå·§å¦™ã€‚


## cr3
	å…¨æ˜¯;86#&;15#&;86#&;15#&;94#&è¿™æ ·çš„ä¸œè¥¿
è§‰å¾—åƒhtml åˆä¸æ˜¯ï¼Œç„¶åä¸€çœ‹ç¬¬ä¸€ä¸ªå°±æ˜¯;æœ‰ç‚¹ä¸ç°å®ï¼Œç„¶åçªå‘å¥‡æƒ³ï¼Œè§‰å¾—æ˜¯å€’ç½®çš„ æœç„¶ï¼Œå€’ç½®ä¸€ä¸‹å°±è§‰çš„åƒäº†ã€‚

![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/cr1.png)

ç„¶åç®€å•äº†ï¼Œåœ¨çº¿çš„htmlè§£å¯†ä¸€ä¸‹ï¼Œç”Ÿæˆä¸€ä¸²16è¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼Œasciiè½¬åŒ–ä¸€ä¸‹ä¼šå‡ºæ¥ä¸€ä¸ª BASE64åŠ å¯†è¿‡çš„æ–‡æœ¬ï¼Œç„¶åå‡ºæ¥çš„è¿˜æ˜¯å¾ˆå¥‡æ€ª åˆbase64è§£å¯†äº†ä¸€æ¬¡ ï¼Œåˆå‡ºflagäº†



## RE1

è¿™é¢˜ä¸»è¦è€ƒéªŒçš„æ˜¯UPXè„±å£³ï¼Œï¼Œç”¨ç°æœ‰çš„UPXè„±å£³å·¥å…·æ¥è§£ä¸€ä¸‹ä¼šå‘ç° ç›´æ¥å°±å¥”æºƒäº†ã€‚ã€‚ã€‚ã€‚ã€‚
åªèƒ½å¤Ÿæ‰‹å·¥è„±å£³ã€‚ã€‚å‚è€ƒæ–‡æ¡£
[http://www.52pojie.cn/thread-259984-1-1.html](http://www.52pojie.cn/thread-259984-1-1.html)


æ‰¾åˆ°ä¸»è¦çš„å‡½æ•°éƒ¨åˆ†å°±å¥½æäº†ã€‚
![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/re1.png)

åœ¨è¿™é‡Œå‘ç°äº†å­—ç¬¦ä¸²çš„å¯¹æ¯”
![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/re2.png)

ç„¶ååˆè¾“å‡ºKEY å¾—åˆ°flag 

## RE2 

æœç´¢å­—ç¬¦ä¸² å‘ç°å¾ˆæ˜æ˜¾çš„ä¸€å¥è¯  ç„¶åè·Ÿè¸ª

![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/re3.png)

æƒ³æ–¹è®¾æ³•æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„åœ°æ–¹

![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/re4.png)

è°ƒè¯•ä¸€ä¸‹è®©ä»–çš„ç®—æ³•è¿è¡Œä¸€ä¸‹ åœ¨ç®—æ³•ç»“æŸçš„æ—¶å€™åœ¨ å†…å­˜ä¸­æ‰¾åˆ°ä»–æ‰€è½¬åŒ–å‡ºæ¥çš„flag 

## RE3
åŒæ ·æœç´¢å­—ç¬¦ä¸²
å¾ˆå®¹æ˜“å°±æ‰¾åˆ°

![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/re5.png)
	
	013410CC  |.  8D4424 40     lea eax,dword ptr ss:[esp+0x40]
	013410D0  |.  83C4 08       add esp,0x8
	013410D3  |.  8D50 01       lea edx,dword ptr ds:[eax+0x1]
	013410D6  |>  8A08          /mov cl,byte ptr ds:[eax]
	013410D8  |.  40            |inc eax
	013410D9  |.  84C9          |test cl,cl
	013410DB  |.^ 75 F9         \jnz short findkey.013410D6
	013410DD  |.  2BC2          sub eax,edx                              ;  åˆ¤æ–­è¾“å…¥çš„é•¿åº¦
	013410DF  |.  83C0 FB       add eax,-0x5
	013410E2  |.  83F8 03       cmp eax,0x3
	013410E5  |.  76 32         jbe short findkey.01341119
	013410E7  |.  8D4C24 1C     lea ecx,dword ptr ss:[esp+0x1C]          ;  æ­£ç¡®çš„ç”¨æˆ·å
	013410EB  |.  8D4424 38     lea eax,dword ptr ss:[esp+0x38]          ;  è¾“å…¥çš„ç”¨æˆ·å
	013410EF  |.  90            nop
	013410F0  |>  8A10          /mov dl,byte ptr ds:[eax]                ;  æ¯”è¾ƒ
	013410F2  |.  3A11          |cmp dl,byte ptr ds:[ecx]
	013410F4  |.  75 1A         |jnz short findkey.01341110
	013410F6  |.  84D2          |test dl,dl
	013410F8  |.  74 12         |je short findkey.0134110C
	013410FA  |.  8A50 01       |mov dl,byte ptr ds:[eax+0x1]
	013410FD  |.  3A51 01       |cmp dl,byte ptr ds:[ecx+0x1]
	01341100  |.  75 0E         |jnz short findkey.01341110
	01341102  |.  83C0 02       |add eax,0x2
	01341105  |.  83C1 02       |add ecx,0x2
	01341108  |.  84D2          |test dl,dl
	0134110A  |.^ 75 E4         \jnz short findkey.013410F0
	0134110C  |>  33C0          xor eax,eax
è¿™é‡Œæ˜¯åˆ¤æ–­ç”¨æˆ·åçš„å­—æ®µ

	0134113B  |.  51            push ecx
	0134113C  |.  51            push ecx
	0134113D  |.  68 AC313401   push findkey.013431AC                    ;  è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼š
	01341142  |.  52            push edx
	01341143  |.  E8 78020000   call findkey.013413C0
	01341148  |.  83C4 0C       add esp,0xC
	0134114B  |.  8BC8          mov ecx,eax
	0134114D  |.  FF15 68303401 call dword ptr ds:[<&MSVCP100.??6?$basic>;  msvcp100.??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAV01@AAV01@@Z@Z
	01341153  |.  8B0D 98303401 mov ecx,dword ptr ds:[<&MSVCP100.?cin@st>;  msvcp100.?cin@std@@3V?$basic_istream@DU?$char_traits@D@std@@@1@A
	01341159  |.  8D4424 1C     lea eax,dword ptr ss:[esp+0x1C]
	0134115D  |.  50            push eax
	0134115E  |.  51            push ecx
	0134115F  |.  E8 AC040000   call findkey.01341610
	01341164  |.  8D4424 24     lea eax,dword ptr ss:[esp+0x24]
	01341168  |.  83C4 08       add esp,0x8
	0134116B  |.  8D50 01       lea edx,dword ptr ds:[eax+0x1]
	0134116E  |.  8BFF          mov edi,edi                              ;  findkey.013443D4
	01341170  |>  8A08          /mov cl,byte ptr ds:[eax]
	01341172  |.  40            |inc eax
	01341173  |.  84C9          |test cl,cl
	01341175  |.^ 75 F9         \jnz short findkey.01341170              ;  åˆ¤æ–­é•¿åº¦
	01341177  |.  2BC2          sub eax,edx
	01341179  |.  8BC8          mov ecx,eax
	0134117B  |.  8D51 FB       lea edx,dword ptr ds:[ecx-0x5]
	0134117E  |.  83FA 06       cmp edx,0x6                              ;  åˆ¤æ–­é•¿åº¦æ˜¯å¦è¶…æ ‡
	01341181  |.  0F87 86000000 ja findkey.0134120D
	01341187  |.  33C0          xor eax,eax
	01341189  |.  85C9          test ecx,ecx
	0134118B  |.  7E 14         jle short findkey.013411A1
	0134118D  |.  8D49 00       lea ecx,dword ptr ds:[ecx]
	01341190  |>  8A5404 1C     /mov dl,byte ptr ss:[esp+eax+0x1C]       ;  è¿™ä¸¤æ­¥æ˜¯å°† è¾“å…¥çš„å­—ç¬¦ä¸ ç›®æ ‡åœ°å€è¿›è¡Œå¼‚æˆ–å¤„ç†
	01341194  |.  325404 10     |xor dl,byte ptr ss:[esp+eax+0x10]
	01341198  |.  40            |inc eax
	01341199  |.  885404 2B     |mov byte ptr ss:[esp+eax+0x2B],dl
	0134119D  |.  3BC1          |cmp eax,ecx
	0134119F  |.^ 7C EF         \jl short findkey.01341190
	013411A1  |>  8D4C24 2C     lea ecx,dword ptr ss:[esp+0x2C]
	013411A5  |.  8D4424 04     lea eax,dword ptr ss:[esp+0x4]
	013411A9  |.  8DA424 000000>lea esp,dword ptr ss:[esp]
	013411B0  |>  8A10          /mov dl,byte ptr ds:[eax]
	013411B2  |.  3A11          |cmp dl,byte ptr ds:[ecx]                ;  æœ€ç»ˆä¸ I_LOVE_CTF_ æ¥æ¯”è¾ƒ
	013411B4  |.  75 1A         |jnz short findkey.013411D0
	013411B6  |.  84D2          |test dl,dl
	013411B8  |.  74 12         |je short findkey.013411CC
	013411BA  |.  8A50 01       |mov dl,byte ptr ds:[eax+0x1]
	013411BD  |.  3A51 01       |cmp dl,byte ptr ds:[ecx+0x1]
	013411C0  |.  75 0E         |jnz short findkey.013411D0
	013411C2  |.  83C0 02       |add eax,0x2
	013411C5  |.  83C1 02       |add ecx,0x2
	013411C8  |.  84D2          |test dl,dl
	013411CA  |.^ 75 E4         \jnz short findkey.013411B0
	013411CC  |>  33C0          xor eax,eax                              ;  æ˜¯å¦æ­£ç¡®
	013411CE  |.  EB 05         jmp short findkey.013411D5

é€šè¿‡ä¸Šé¢çš„è¯­å¥æ¥è¿›è¡Œå¯¹æ¯”åˆ†æ è‡ªå·±åœ¨å†™ä¸€ä¸‹ å¼‚æˆ–å¤„ç†  flagé©¬ä¸Šå°±èƒ½å¤Ÿå¾—åˆ°

	00B4FCE8  3A352A10  *5:
	00B4FCEC  03333C1B  <3
	00B4FCF0  017E2322  "#~
è¿™ä¸€å—æ˜¯è¦ä¸ä¹‹å¼‚æˆ–å¤„ç†çš„å­—ç¬¦ä¸²

##ã€€RE4

è¿™æ˜¯ä¸€ä¸ªçƒ¦äººçš„ç¨‹åº

![](https://raw.githubusercontent.com/GoldsNow/-/b724e8178d820394f4ba4c3e952db3d90ac569a5/2016-5-16/%E9%A3%8E%E4%BA%91%E6%9D%AF/re6.png)

åˆ†æä¸€ä¸‹ä»£ç ã€€ã€€ä¸»è¦çš„æ“ä½œæ˜¯è¿›è¡Œè¿™ä¸€æ­¥ã€€ç„¶åè¿™ä¸ªå¼¹å‡ºçª—å£å¾ˆçƒ¦äººã€€ç”¨ï¼¯ï¼¤æŠŠã€€å…¶ä¸­çš„ä¸€ä¸ªï¼å‚æ•°æ”¹ä¸ºï¼‘ã€€ç„¶åçª—å£å°±ä¸ä¼šè·³å‡ºæ¥äº†ï¼Œï¼Œ
ï½ï½ï½”ï½ƒï½ˆä¸€ä¸‹ã€€è®©ç¨‹åºæ…¢æ…¢çš„è·‘ã€€çœŸçš„å¤ªæ…¢äº†ï¼Œå› ä¸ºä¸€å…±æœ‰å››ä¸ªè¾“å‡ºå‡½æ•°ï¼Œ
ä¸€ä¸ªå°†å‰é¢ä¸‰ä¸ªï¼®ï¼¯ï¼°æ‰ã€€å¦å¤–ä¸€ä¸ªå°†å‰é¢ä¸¤ä¸ªï½ï½ï½æ‰ã€€å°±è¿™æ ·å¤šå¼€æ¥è¿›è¡Œï½†ï½Œï½ï½‡çš„è¾“å‡º

å“ˆå“ˆã€€æœ€ç»ˆè¿˜æ˜¯è¿‡äº†
ä¸‹å›è¿˜æ˜¯è¦å¥½å¥½çš„åˆ†æä¸€ä¸‹ã€‚

## android1
ä¼ªåŠ å¯†
å’Œä¸Šé¢MISCä¸€æ ·è„±æ‰åŠ å¯†

ç„¶åç”¨JEBæ‰“å¼€ flagç›´æ¥å‡ºç°

## android2

é¢˜ç›®æç¤ºåœ¨ å†…å­˜ä¸­ï¼Œç¿»è¯‘ä¸‹æ±‡ç¼–ä»£ç   å‡ºç°äº† ç„¶åæäº¤å°±å¯¹äº†


## android3
åŒæ ·ç”¨JEBæ‰“å¼€ ç„¶åå‡ºç°ï½›ä¸€ä¸²asciiï½ å¤„ç†ä¸€ä¸‹ç›´æ¥å‡ºflag





